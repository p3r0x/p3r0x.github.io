<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="coppersmith å®šç†çš„å‡ ç§æ”»å‡»æƒ…å†µçš„å­¦ä¹  Coppersmith å¯ä»¥ç”¨äºæ±‚å¤šé¡¹å¼çš„å°æ ¹ï¼Œç»å¸¸ç”¨äº RSA æ”»å‡»ä¸­â€œå·²çŸ¥æŸäº›äºŒè¿›åˆ¶ä½ï¼Œæ±‚å‰©ä½™ä½â€è¿™ä¸€ç±»é—®é¢˜\nç»™å®šï¼š\næ¨¡æ•° Nï¼ˆé€šå¸¸å¾ˆå¤§ï¼Œå¦‚ RSA æ¨¡æ•°ï¼‰ æ¨¡ N çš„å¤šé¡¹å¼ f(x)ï¼ˆé€šå¸¸ä¸ºå•å˜é‡ï¼‰ è¾¹ç•Œ X å¯»æ‰¾æ‰€æœ‰æ»¡è¶³ f(x0) â‰¡ 0 (mod N)ä¸” âˆ£x0âˆ£ &lt; X çš„æ•´æ•°æ ¹ x0\n">
<title>Coppersmithå®šç†çš„å‡ ç§æ”»å‡»æƒ…å†µçš„å­¦ä¹ </title>

<link rel='canonical' href='http://localhost:1313/p/coppersmith%E5%AE%9A%E7%90%86%E7%9A%84%E5%87%A0%E7%A7%8D%E6%94%BB%E5%87%BB%E6%83%85%E5%86%B5%E7%9A%84%E5%AD%A6%E4%B9%A0/'>

<link rel="stylesheet" href="/scss/style.min.b0e76e98cdd4f7082d1fc36f7af7e0843a81201db2197c03ca426751dc923735.css"><meta property='og:title' content="Coppersmithå®šç†çš„å‡ ç§æ”»å‡»æƒ…å†µçš„å­¦ä¹ ">
<meta property='og:description' content="coppersmith å®šç†çš„å‡ ç§æ”»å‡»æƒ…å†µçš„å­¦ä¹  Coppersmith å¯ä»¥ç”¨äºæ±‚å¤šé¡¹å¼çš„å°æ ¹ï¼Œç»å¸¸ç”¨äº RSA æ”»å‡»ä¸­â€œå·²çŸ¥æŸäº›äºŒè¿›åˆ¶ä½ï¼Œæ±‚å‰©ä½™ä½â€è¿™ä¸€ç±»é—®é¢˜\nç»™å®šï¼š\næ¨¡æ•° Nï¼ˆé€šå¸¸å¾ˆå¤§ï¼Œå¦‚ RSA æ¨¡æ•°ï¼‰ æ¨¡ N çš„å¤šé¡¹å¼ f(x)ï¼ˆé€šå¸¸ä¸ºå•å˜é‡ï¼‰ è¾¹ç•Œ X å¯»æ‰¾æ‰€æœ‰æ»¡è¶³ f(x0) â‰¡ 0 (mod N)ä¸” âˆ£x0âˆ£ &lt; X çš„æ•´æ•°æ ¹ x0\n">
<meta property='og:url' content='http://localhost:1313/p/coppersmith%E5%AE%9A%E7%90%86%E7%9A%84%E5%87%A0%E7%A7%8D%E6%94%BB%E5%87%BB%E6%83%85%E5%86%B5%E7%9A%84%E5%AD%A6%E4%B9%A0/'>
<meta property='og:site_name' content='Perox'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2026-01-02T20:47:05&#43;08:00'/><meta property='article:modified_time' content='2026-01-02T20:47:05&#43;08:00'/><meta property='og:image' content='http://localhost:1313/p/coppersmith%E5%AE%9A%E7%90%86%E7%9A%84%E5%87%A0%E7%A7%8D%E6%94%BB%E5%87%BB%E6%83%85%E5%86%B5%E7%9A%84%E5%AD%A6%E4%B9%A0/image.png' />
<meta name="twitter:title" content="Coppersmithå®šç†çš„å‡ ç§æ”»å‡»æƒ…å†µçš„å­¦ä¹ ">
<meta name="twitter:description" content="coppersmith å®šç†çš„å‡ ç§æ”»å‡»æƒ…å†µçš„å­¦ä¹  Coppersmith å¯ä»¥ç”¨äºæ±‚å¤šé¡¹å¼çš„å°æ ¹ï¼Œç»å¸¸ç”¨äº RSA æ”»å‡»ä¸­â€œå·²çŸ¥æŸäº›äºŒè¿›åˆ¶ä½ï¼Œæ±‚å‰©ä½™ä½â€è¿™ä¸€ç±»é—®é¢˜\nç»™å®šï¼š\næ¨¡æ•° Nï¼ˆé€šå¸¸å¾ˆå¤§ï¼Œå¦‚ RSA æ¨¡æ•°ï¼‰ æ¨¡ N çš„å¤šé¡¹å¼ f(x)ï¼ˆé€šå¸¸ä¸ºå•å˜é‡ï¼‰ è¾¹ç•Œ X å¯»æ‰¾æ‰€æœ‰æ»¡è¶³ f(x0) â‰¡ 0 (mod N)ä¸” âˆ£x0âˆ£ &lt; X çš„æ•´æ•°æ ¹ x0\n"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='http://localhost:1313/p/coppersmith%E5%AE%9A%E7%90%86%E7%9A%84%E5%87%A0%E7%A7%8D%E6%94%BB%E5%87%BB%E6%83%85%E5%86%B5%E7%9A%84%E5%AD%A6%E4%B9%A0/image.png' />
    <link rel="shortcut icon" href="/favicon.ico" />

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            localStorage.setItem(colorSchemeKey, "dark");
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="åˆ‡æ¢èœå•">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu_9093c608f3f56ca.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Perox</a></h1>
            <h2 class="site-description">è½»åº¦å´©æºƒ(1)</h2>
        </div>
    </header><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>ä¸»é¡µ</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%85%B3%E4%BA%8E/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>å…³äº</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>å½’æ¡£</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>æœç´¢</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>å‹é“¾</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ç›®å½•</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#1basic-boradcast-attack-å¹¿æ’­æ”»å‡»">1.basic boradcast attack å¹¿æ’­æ”»å‡»</a>
      <ol>
        <li><a href="#æ”»å‡»åŸç†">æ”»å‡»åŸç†</a></li>
      </ol>
    </li>
    <li><a href="#rsa-é«˜ä½æ”»å‡»">RSA é«˜ä½æ”»å‡»</a>
      <ol>
        <li><a href="#å·²çŸ¥-p-é«˜ä½">å·²çŸ¥ p é«˜ä½</a></li>
        <li><a href="#å·²çŸ¥-p-é«˜ä½q-ä½ä½">å·²çŸ¥ p é«˜ä½ï¼Œq ä½ä½</a></li>
        <li><a href="#å·²çŸ¥å¯†æ–‡-m-é«˜ä½">å·²çŸ¥å¯†æ–‡ m é«˜ä½</a></li>
        <li><a href="#å·²çŸ¥-d-çš„ä½ä½æ±‚-pq">å·²çŸ¥ d çš„ä½ä½æ±‚ pq</a></li>
      </ol>
    </li>
    <li><a href="#franklin-reiter-ç›¸å…³æ¶ˆæ¯æ”»å‡»--coppersmiths-short-pad-attack-çŸ­å¡«å……æ”»å‡»">Franklin-Reiter ç›¸å…³æ¶ˆæ¯æ”»å‡» &amp; Coppersmith&rsquo;s Short Pad Attack çŸ­å¡«å……æ”»å‡»</a>
      <ol>
        <li><a href="#æ”»å‡»åŸç†-1">æ”»å‡»åŸç†</a></li>
        <li><a href="#åšä¸‹ä¾‹é¢˜">åšä¸‹ä¾‹é¢˜</a></li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/coppersmith%E5%AE%9A%E7%90%86%E7%9A%84%E5%87%A0%E7%A7%8D%E6%94%BB%E5%87%BB%E6%83%85%E5%86%B5%E7%9A%84%E5%AD%A6%E4%B9%A0/">
                <img src="/p/coppersmith%E5%AE%9A%E7%90%86%E7%9A%84%E5%87%A0%E7%A7%8D%E6%94%BB%E5%87%BB%E6%83%85%E5%86%B5%E7%9A%84%E5%AD%A6%E4%B9%A0/image_hu_4170bc19d00641b7.png"
                        srcset="/p/coppersmith%E5%AE%9A%E7%90%86%E7%9A%84%E5%87%A0%E7%A7%8D%E6%94%BB%E5%87%BB%E6%83%85%E5%86%B5%E7%9A%84%E5%AD%A6%E4%B9%A0/image_hu_4170bc19d00641b7.png 800w, /p/coppersmith%E5%AE%9A%E7%90%86%E7%9A%84%E5%87%A0%E7%A7%8D%E6%94%BB%E5%87%BB%E6%83%85%E5%86%B5%E7%9A%84%E5%AD%A6%E4%B9%A0/image_hu_c62fed0446e21fe0.png 1600w"
                        width="800" 
                        height="503" 
                        loading="lazy"
                        alt="Featured image of post Coppersmithå®šç†çš„å‡ ç§æ”»å‡»æƒ…å†µçš„å­¦ä¹ " />
                
            </a>
        </div>
    

    <div class="article-details">
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/coppersmith%E5%AE%9A%E7%90%86%E7%9A%84%E5%87%A0%E7%A7%8D%E6%94%BB%E5%87%BB%E6%83%85%E5%86%B5%E7%9A%84%E5%AD%A6%E4%B9%A0/">Coppersmithå®šç†çš„å‡ ç§æ”»å‡»æƒ…å†µçš„å­¦ä¹ </a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published" datetime='2026-01-02T20:47:05&#43;08:00'>2026-01-02</time>
            </div>
        

        
    </footer>
    

    
</div>

</header>

    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <div style="color: #999; font-size: 14px; margin-bottom: 20px; padding: 10px; background: rgba(0,0,0,0.05); border-radius: 5px;">
        é˜…è¯»é‡: <span id="busuanzi_value_page_pv">0</span>
    </div>

    <section class="article-content">
    
    
    <h1 id="coppersmith-å®šç†çš„å‡ ç§æ”»å‡»æƒ…å†µçš„å­¦ä¹ ">coppersmith å®šç†çš„å‡ ç§æ”»å‡»æƒ…å†µçš„å­¦ä¹ 
</h1><p>Coppersmith å¯ä»¥ç”¨äºæ±‚å¤šé¡¹å¼çš„å°æ ¹ï¼Œç»å¸¸ç”¨äº RSA æ”»å‡»ä¸­â€œå·²çŸ¥æŸäº›äºŒè¿›åˆ¶ä½ï¼Œæ±‚å‰©ä½™ä½â€è¿™ä¸€ç±»é—®é¢˜</p>
<p>ç»™å®šï¼š</p>
<ul>
<li>æ¨¡æ•° Nï¼ˆé€šå¸¸å¾ˆå¤§ï¼Œå¦‚ RSA æ¨¡æ•°ï¼‰</li>
<li>æ¨¡ N çš„å¤šé¡¹å¼ f(x)ï¼ˆé€šå¸¸ä¸ºå•å˜é‡ï¼‰</li>
<li>è¾¹ç•Œ X</li>
</ul>
<p>å¯»æ‰¾æ‰€æœ‰æ»¡è¶³ f(x0) â‰¡ 0 (mod N)ä¸” âˆ£x0âˆ£ &lt; X çš„æ•´æ•°æ ¹ x0</p>
<p>æˆç«‹çš„æ¡ä»¶ï¼š
</p>
$$
|x_0|\ <\ N^{1/deg(f)}\\
$$<p>
deg(f)ä¸ºå¤šé¡¹å¼æœ€é«˜é¡¹ç³»æ•°</p>
<h2 id="1basic-boradcast-attack-å¹¿æ’­æ”»å‡»">1.basic boradcast attack å¹¿æ’­æ”»å‡»
</h2><h3 id="æ”»å‡»åŸç†">æ”»å‡»åŸç†
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Broadcast attack æ˜¯ HÃ¥stad attackï¼Œä¸æ˜¯ Coppersmithï¼Œåªæ˜¯ç»å¸¸ä¸€èµ·å‡ºç°
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä½¿ç”¨åŒä¸€ä¸ªæŒ‡æ•° e åŠ å¯†åŒä¸€ä¸ªå¯†æ–‡ mï¼Œäº§ç”Ÿ e ä¸ªæ˜æ–‡ï¼Œå½¢å¦‚ï¼š
</p>
$$
c_1 \equiv m^e \pmod{n_1} \\
c_2 \equiv m^e \pmod{n_2} \\
\vdots \\
c_e \equiv m^e \pmod{n_e}
$$<p>
n1, n2&hellip;äº’ç´ ï¼Œ</p>
<p>æ˜¯ m â‰¤ min(nâ‚, nâ‚‚, â€¦, nâ‚‘)ï¼Œå³æ˜æ–‡ m å¿…é¡»å°äºç­‰äºæ‰€æœ‰æ¨¡æ•°ä¸­çš„æœ€å°å€¼</p>
<p>ç„¶åè§£ä¸­å›½å‰©ä½™å®šç†</p>
<p>æ ¹æ®ä¸­å›½å‰©ä½™å®šç†ï¼ˆCRTï¼‰ï¼Œå¯ä»¥æ±‚è§£ï¼š</p>
<p>máµ‰ â‰¡ C (mod N)</p>
<p>å…¶ä¸­ N = nâ‚ Ã— nâ‚‚ Ã— â€¦ Ã— nâ‚‘</p>
<p>å› ä¸º m â‰¤ min(nâ‚, nâ‚‚, â€¦, nâ‚‘)ï¼Œm^e^ &lt; nâ‚ Ã— nâ‚‚ Ã— â€¦ Ã— nâ‚‘</p>
<p>máµ‰ &lt; Nï¼Œåˆ™å¯ä»¥ç›´æ¥å¯¹ C å¼€ e æ¬¡æ–¹æ ¹å¾—åˆ°æ˜æ–‡ mï¼šm = áµ‰âˆšC</p>
<h2 id="rsa-é«˜ä½æ”»å‡»">RSA é«˜ä½æ”»å‡»
</h2><p>å†…å®¹å‚è€ƒï¼š</p>
<p><a class="link" href="https://blog.csdn.net/lc9992023/article/details/141112336"  target="_blank" rel="noopener"
    >RSA_é«˜ä½æ”»å‡»å­¦ä¹ è®°å½•_rsa å·²çŸ¥é«˜ä½æ”»å‡»-CSDN åšå®¢</a></p>
<p><a class="link" href="https://blog.csdn.net/qq_51999772/article/details/123620932"  target="_blank" rel="noopener"
    >RSA ä¸­ coppersmith å®šç†çš„åº”ç”¨æ¡ä»¶-CSDN åšå®¢</a></p>
<p><a class="link" href="https://www.ruanx.net/coppersmith/"  target="_blank" rel="noopener"
    >Coppersmith æ”»å‡»</a></p>
<p>çŸ¥é“éƒ¨åˆ†äºŒè¿›åˆ¶ä½ï¼Œæ±‚å‰©ä½™äºŒè¿›åˆ¶ä½ï¼Œ<strong>åªæœ‰æœªçŸ¥çš„ bit ä½æ»¡è¶³ unknown_bits / p_bits &lt;= 0.44ï¼ˆå³ coppersmith å®šç†ï¼‰æ—¶ï¼Œæ‰èƒ½é€šè¿‡ small_roots()æ–¹æ³•æ±‚å‡ºæœªçŸ¥çš„ bit ä½ï¼Œè¿›è€Œæ±‚è§£ flag</strong></p>
<p>small_roots(X = , beta = )çš„ä½¿ç”¨æ–¹æ³•ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sage" data-lang="sage"><span class="line"><span class="cl"><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Zmod</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>      <span class="c1"># å®šä¹‰æ¨¡Nçš„å¤šé¡¹å¼ç¯</span>
</span></span><span class="line"><span class="cl"><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span><span class="o">^</span><span class="n">e</span> <span class="o">-</span> <span class="n">c</span>                     <span class="c1"># å®šä¹‰å¤šé¡¹å¼</span>
</span></span><span class="line"><span class="cl"><span class="n">roots</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">small_roots</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="p">,</span><span class="n">beta</span><span class="o">=</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>çœ‹ä¸æ‡‚ï¼Œè®© ai ç»†è¯´äº†ä¸€ä¸‹</p>
<p>è¾¹ç•Œå› ç´  Xï¼š</p>
<ol>
<li>å·²çŸ¥æ ¹çš„æ¯”ç‰¹ k çš„æƒ…å†µä¸‹ï¼ŒX = 2^k^</li>
<li>å·²çŸ¥æ ¹çš„å¤§è‡´èŒƒå›´ [0,1000]ï¼ŒX = 1000</li>
<li>ç†è®ºè¾¹ç•Œï¼šæ ¹æ® coppersmith: X &lt; N^1/e^ï¼Œæ‰€ä»¥ X = floor(N^1/e^)</li>
<li>å› å­çš„éƒ¨åˆ†æ¯”ç‰¹æ”»å‡»ï¼ŒçŸ¥é“äº† p çš„é«˜ä½ï¼Œp = p_high+xï¼Œæ‰€ä»¥ X = 2^unknown_bits^</li>
</ol>
<p>beta å‚æ•°ï¼ˆÎ²ï¼‰ï¼šå½“ p, q äºŒè¿›åˆ¶ä½æ•°ç›¸åŒæ—¶ä¸€èˆ¬åªèƒ½å– 0.4</p>
<ol>
<li>
<p>åœ¨æ¨¡ N ä¸Šå¯»æ‰¾æ ¹ï¼Œå¦‚æœæ ¹æ»¡è¶³ f(x) â‰¡ 0 (mod N)ï¼Œbeta = 1</p>
</li>
<li>
<p>åœ¨æ¨¡ p ä¸Šå¯»æ‰¾æ ¹ï¼Œä¸” p çº¦ç­‰äº N^0.5^ï¼ˆRSA æƒ…å†µï¼‰ï¼Œp æ˜¯ N çš„ä¸€ä¸ªå› å­ï¼Œp â‰ˆ âˆšN â‰ˆ N^0.5ï¼Œbeta = 0.5ï¼Œå› ä¸º p â‰ˆ N^0.5ï¼Œæ‰€ä»¥ Î² = 0.5</p>
</li>
<li>
<p>åœ¨æ¨¡ p ä¸Šå¯»æ‰¾æ ¹ï¼Œä½† p çš„å¤§å°ä¸åŒï¼š</p>
<p>å¦‚æœ p â‰ˆ N^0.3^ï¼šbeta = 0.3</p>
<p>å¦‚æœ p â‰ˆ N^0.25ï¼šbeta = 0.25</p>
</li>
<li>
<p>å¯»æ‰¾æ¨¡ N çš„å°æ ¹ï¼šbeta = 1.0</p>
</li>
</ol>
<div class="table-wrapper"><table>
  <thead>
      <tr>
          <th>æ”»å‡»ç›®æ ‡</th>
          <th>æ¨¡æ•°</th>
          <th>Î²</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>æ¨¡ N æ±‚æ ¹</td>
          <td>N</td>
          <td>1.0</td>
      </tr>
      <tr>
          <td>æ¨¡ pï¼ˆRSAï¼‰</td>
          <td>p â‰ˆ N^0.5</td>
          <td>0.5</td>
      </tr>
      <tr>
          <td>æ¨¡ p â‰ˆ N^0.3</td>
          <td>p</td>
          <td>0.3</td>
      </tr>
  </tbody>
</table></div>
<h3 id="å·²çŸ¥-p-é«˜ä½">å·²çŸ¥ p é«˜ä½
</h3><p>çŸ¥é“ p çš„å‰ k ä½ï¼Œè®°ä½ä½ä¸º xï¼Œæ‰€ä»¥ p = p_high * 2^k^ + xï¼Œç®—å‡º p çš„ä½ä½ x åç›´æ¥ç”¨ small_roots</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span><span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">q</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">n</span><span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">p_high</span> <span class="o">=</span> <span class="n">p</span> <span class="o">&gt;&gt;</span> <span class="mi">300</span><span class="c1">#å·²çŸ¥é«˜ä½1024-300bits</span>
</span></span><span class="line"><span class="cl"><span class="n">pbits</span> <span class="o">=</span> <span class="mi">1024</span>
</span></span><span class="line"><span class="cl"><span class="n">kbits</span> <span class="o">=</span> <span class="n">pbits</span> <span class="o">-</span> <span class="n">p_high</span><span class="o">.</span><span class="n">bit_length</span><span class="p">()</span><span class="c1">#ä½ä½300bits</span>
</span></span><span class="line"><span class="cl"><span class="n">p_high</span> <span class="o">=</span> <span class="n">p_high</span> <span class="o">&lt;&lt;</span> <span class="n">kbits</span><span class="c1">#ç§»åŠ¨å›å»æŠŠä½ä½ç©ºå‡ºæ¥</span>
</span></span><span class="line"><span class="cl"><span class="n">PR</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Zmod</span><span class="p">(</span><span class="n">n</span><span class="p">))</span><span class="c1">#å¤šé¡¹å¼ç¯</span>
</span></span><span class="line"><span class="cl"><span class="n">f</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">p_high</span>
</span></span><span class="line"><span class="cl"><span class="n">p0</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">small_roots</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">kbits</span><span class="p">,</span><span class="mf">0.4</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">p0</span><span class="o">+</span><span class="n">p_high</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="å·²çŸ¥-p-é«˜ä½q-ä½ä½">å·²çŸ¥ p é«˜ä½ï¼Œq ä½ä½
</h3><p>å·²çŸ¥çš„ p é«˜ä½ä¸æ»¡è¶³ unknown_bits / p_bits &lt;= 0.44ï¼Œä¸”çŸ¥é“ q çš„ä½ä½ï¼Œä½ä½æ•° x</p>
<p>è§£é¢˜æ–¹æ³•çœä¸ªæµå°±æ˜¯ï¼š
</p>
$$
p_{\text{low}} = p \bmod 2^{x} = \left( n \cdot q_{\text{low}}^{-1} \right) \bmod 2^{x}
$$<p>
ç„¶åç”¨ small_roots ç®—å‡ºä¸­é—´çš„æœªçŸ¥æ•°ç„¶ååŠ èµ·æ¥å°±å¯ä»¥äº†</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">getPrime</span><span class="p">,</span> <span class="n">bytes_to_long</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">secret</span> <span class="kn">import</span> <span class="n">flag</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">q</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span>
</span></span><span class="line"><span class="cl"><span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span>
</span></span><span class="line"><span class="cl"><span class="n">hint1</span> <span class="o">=</span> <span class="n">p</span> <span class="o">&gt;&gt;</span> <span class="mi">724</span>
</span></span><span class="line"><span class="cl"><span class="n">hint2</span> <span class="o">=</span> <span class="n">q</span> <span class="o">%</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="mi">265</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">bytes_to_long</span><span class="p">(</span><span class="n">flag</span><span class="p">),</span> <span class="n">e</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">hint1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">hint2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>q çš„ä½ä½ q_low
</p>
$$
q \bmod 2^{265} = q_{\text{low}}
$$<p>
æ‰€ä»¥ï¼š
</p>
$$
q = k \cdot 2^{265} + q_{\text{low}}
$$<p>
ä¸¤è¾¹åŒæ—¶ä¹˜ q å¯ä»¥å¾—åˆ°ï¼š
</p>
$$
n = p \cdot \left( k \cdot 2^{265} + q_{\text{low}} \right) = k \cdot 2^{265} \cdot p + q_{\text{low}} \cdot p
$$<p>
åŒæ—¶é™¤ä»¥ q_lowï¼š
</p>
$$
n \cdot q_{\text{low}}^{-1} = k \cdot 2^{265} \cdot p \cdot q_{\text{low}}^{-1} + p
$$<p>
åŒæ—¶å–æ¨¡ 2^265^å¾—åˆ°ï¼š
</p>
$$
p_{\text{low}} = p \bmod 2^{265} = \left( n \cdot q_{\text{low}}^{-1} \right) \bmod 2^{265}
$$<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span><span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">p_high</span> <span class="o">=</span> <span class="mi">1514296530850131082973956029074258536069144071110652176122006763622293335057110441067910479</span>
</span></span><span class="line"><span class="cl"><span class="n">q_low</span> <span class="o">=</span> <span class="mi">40812438243894343296354573724131194431453023461572200856406939246297219541329623</span>
</span></span><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="mi">21815431662065695412834116602474344081782093119269423403335882867255834302242945742413692949886248581138784199165404321893594820375775454774521554409598568793217997859258282700084148322905405227238617443766062207618899209593375881728671746850745598576485323702483634599597393910908142659231071532803602701147251570567032402848145462183405098097523810358199597631612616833723150146418889589492395974359466777040500971885443881359700735149623177757865032984744576285054725506299888069904106805731600019058631951255795316571242969336763938805465676269140733371287244624066632153110685509892188900004952700111937292221969</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="mi">19073695285772829730103928222962723784199491145730661021332365516942301513989932980896145664842527253998170902799883262567366661277268801440634319694884564820420852947935710798269700777126717746701065483129644585829522353341718916661536894041337878440111845645200627940640539279744348235772441988748977191513786620459922039153862250137904894008551515928486867493608757307981955335488977402307933930592035163126858060189156114410872337004784951228340994743202032248681976932591575016798640429231399974090325134545852080425047146251781339862753527319093938929691759486362536986249207187765947926921267520150073408188188</span>
</span></span><span class="line"><span class="cl"><span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span>
</span></span><span class="line"><span class="cl"><span class="n">p_low</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="o">//</span><span class="n">q_low</span><span class="p">)</span><span class="o">%</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">256</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">p_low</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç°åœ¨æœ‰ä½ä½ 256 å’Œé«˜ä½ 300ï¼Œæ‰€ä»¥ç›®å‰æœªçŸ¥ä½ä¸º 459ï¼Œæœ€å¤šæœªçŸ¥ä½ä¸º 1024 * 0.44 = 454ï¼Œæ‰€ä»¥è¦æš´åŠ›æšä¸¾äº”ä½</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span><span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">p_high</span> <span class="o">=</span> <span class="mi">1514296530850131082973956029074258536069144071110652176122006763622293335057110441067910479</span>
</span></span><span class="line"><span class="cl"><span class="n">q_low</span> <span class="o">=</span> <span class="mi">40812438243894343296354573724131194431453023461572200856406939246297219541329623</span>
</span></span><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="mi">21815431662065695412834116602474344081782093119269423403335882867255834302242945742413692949886248581138784199165404321893594820375775454774521554409598568793217997859258282700084148322905405227238617443766062207618899209593375881728671746850745598576485323702483634599597393910908142659231071532803602701147251570567032402848145462183405098097523810358199597631612616833723150146418889589492395974359466777040500971885443881359700735149623177757865032984744576285054725506299888069904106805731600019058631951255795316571242969336763938805465676269140733371287244624066632153110685509892188900004952700111937292221969</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="mi">19073695285772829730103928222962723784199491145730661021332365516942301513989932980896145664842527253998170902799883262567366661277268801440634319694884564820420852947935710798269700777126717746701065483129644585829522353341718916661536894041337878440111845645200627940640539279744348235772441988748977191513786620459922039153862250137904894008551515928486867493608757307981955335488977402307933930592035163126858060189156114410872337004784951228340994743202032248681976932591575016798640429231399974090325134545852080425047146251781339862753527319093938929691759486362536986249207187765947926921267520150073408188188</span>
</span></span><span class="line"><span class="cl"><span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span>
</span></span><span class="line"><span class="cl"><span class="n">q_low_inv</span><span class="o">=</span><span class="nb">pow</span><span class="p">(</span><span class="n">q_low</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">**</span><span class="mi">265</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">p_low</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">q_low_inv</span><span class="p">)</span><span class="o">%</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">265</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">p_low</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">PR</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Zmod</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">p_high</span><span class="o">=</span><span class="n">p_high</span> <span class="o">&lt;&lt;</span> <span class="mi">724</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">f</span> <span class="o">=</span> <span class="n">p_high</span> <span class="o">+</span> <span class="n">p_low</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="mi">32</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">265</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">monic</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">small_roots</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">454</span><span class="p">,</span><span class="mf">0.4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">p</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">x0</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="n">p</span><span class="o">=</span><span class="p">(</span><span class="n">x0</span><span class="o">*</span><span class="mi">32</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">265</span><span class="p">)</span> <span class="o">+</span> <span class="n">p_high</span> <span class="o">+</span> <span class="n">p_low</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">q</span><span class="o">=</span><span class="n">n</span><span class="o">//</span><span class="n">p</span>
</span></span><span class="line"><span class="cl"><span class="n">phi</span><span class="o">=</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">d</span><span class="o">=</span><span class="nb">pow</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">phi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">n</span><span class="p">)))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>md è¿˜èƒ½æœ‰è¿™ç§æŠ¥é”™çš„ï¼Œå¤¸å¼ å“¦ ğŸ˜“</p>
<h3 id="å·²çŸ¥å¯†æ–‡-m-é«˜ä½">å·²çŸ¥å¯†æ–‡ m é«˜ä½
</h3><p>æ€ä¹ˆæ„Ÿè§‰åƒç…§ç€æŠ„å•Šæˆ‘å¹²</p>
<p>m å’Œ c çš„å…³ç³»æ˜¯
</p>
$$
c = m^e \mod n
$$<p>
åˆå› ä¸ºï¼š
</p>
$$
m = m_{\text{high}} + x \quad (\text{$x$ æ˜¯ä½ä½æœªçŸ¥})
$$<p>
æ‰€ä»¥æŠŠ c ç§»è¿‡æ¥å¯ä»¥å˜æˆï¼š
</p>
$$
f(x) = (m_{\text{high}} + x)^e - c \equiv 0 \mod n
$$<p>
ç„¶åç›´æ¥å¥—å…¬å¼ç§’äº†</p>
<h3 id="å·²çŸ¥-d-çš„ä½ä½æ±‚-pq">å·²çŸ¥ d çš„ä½ä½æ±‚ pq
</h3><p>å·²çŸ¥äº† d çš„ä½ä½ d_low å’Œä½ä½ bits æ•° x è¿˜æœ‰ e</p>
<p>å› ä¸ºï¼š
</p>
$$
ed \equiv 1 \pmod{(p-1)(q-1)}
$$<p>
æ‰€ä»¥ï¼šed = 1 + k * (p-1) * (q-1)</p>
<p>ç„¶åå¯¹ä¸¤è¾¹å–æ¨¡ 2^x^ï¼Œæ‰€ä»¥:
</p>
$$
ed_{\text{low}} \equiv 1 + k(p-1)(q-1) \pmod{2^x}
$$<p>
æŠŠ q æ¢æˆ n/pï¼Œè¿™ä¸ªå¼å­å°±ä¸º
</p>
$$
p \cdot ed_{low} \equiv p + k(n \cdot p - p^{2} - n + p) \pmod{2^{x}}
$$<p>
ç„¶å solve_mod è§£æ¨¡æ–¹ç¨‹ï¼ˆsagemath å¤ªå¥½ç”¨äº†å®¶äººä»¬ï¼‰</p>
<h2 id="franklin-reiter-ç›¸å…³æ¶ˆæ¯æ”»å‡»--coppersmiths-short-pad-attack-çŸ­å¡«å……æ”»å‡»">Franklin-Reiter ç›¸å…³æ¶ˆæ¯æ”»å‡» &amp; Coppersmith&rsquo;s Short Pad Attack çŸ­å¡«å……æ”»å‡»
</h2><h3 id="æ”»å‡»åŸç†-1">æ”»å‡»åŸç†
</h3><p>ç”±äº m1 å’Œ m2 å­˜åœ¨çº¿æ€§å…³ç³»å¹¶ä¸”åœ¨ç›¸åŒ N ä¸‹è¿›è¡Œçš„ RSA åŠ å¯†ï¼Œ</p>
<p>å‡è®¾
</p>
$$
m_1 = k\ * \ m_2 \ +\ b
$$<p>
ä¸”
</p>
$$
m_1\ \equiv \ a\ mod \ N\\
m_2\ \equiv \ a\ mod \ N
$$<p>
è¿™æ ·å°±å¯ä»¥åˆ—å‡ºä¸¤ä¸ªå’Œ m2 ç›¸å…³çš„æ–¹ç¨‹
</p>
$$
f(x)\ =\ x\ -\ a\\f(x)= k\ * \ x \ +\ b\ -\ a
$$<p>
è¿™æ ·è¿™ä¸¤ä¸ªå¼å­å– <strong>x = m2</strong> æ—¶éƒ½ä¼šç­‰äº 0ï¼Œåœ¨æ•°å­¦æ„ä¹‰ä¸‹æœ‰ä¸ª <strong>(x-m2)</strong> çš„å› å¼ï¼Œæ‰€ä»¥ç›´æ¥å–è¿™ä¸¤ä¸ªæ–¹ç¨‹çš„å…¬å› æ•°å°±å¯ä»¥æ‰¾åˆ° m2</p>
<p>é¡ºä¾¿å­¦ä¹ ä¸€ä¸‹ sagemath</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">R</span><span class="o">.&lt;</span><span class="n">X</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Zmod</span><span class="p">(</span><span class="n">n</span><span class="p">)[]</span><span class="c1">#å®šä¹‰å¤šé¡¹å¼ç¯</span>
</span></span><span class="line"><span class="cl"><span class="o">.</span><span class="n">coefficients</span><span class="p">()</span><span class="c1">#ä»¥åˆ—è¡¨å½¢å¼è¿”å›å¤šé¡¹å¼çš„å¸¸æ•°é¡¹ï¼ˆä»ä½é¡¹åˆ°é«˜é¡¹çš„å‡åºæ’åˆ—ï¼Œå³7x^5+3x^4+4è¿”å›[4,3,7]ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="o">.</span><span class="n">monic</span><span class="p">()</span><span class="c1">#é™¤ä»¥æœ€é«˜é¡¹çš„ç³»æ•°</span>
</span></span><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">4x^3+2x^2+x
</span></span></span><span class="line"><span class="cl"><span class="s1">è¿”å›ï¼š
</span></span></span><span class="line"><span class="cl"><span class="s1">x^3+1/2x^2+1/4x
</span></span></span><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#å¤šé¡¹å¼æ±‚å…¬å› æ•°ç”¨æ¬§å‡ é‡Œå¾—ç®—æ³•é€’å½’</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">gcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="n">b</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">monic</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">gcd</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">%</span> <span class="n">b</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="åšä¸‹ä¾‹é¢˜">åšä¸‹ä¾‹é¢˜
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">secret</span> <span class="kn">import</span> <span class="n">flag</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">m1</span> <span class="o">=</span> <span class="n">bytes_to_long</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">N</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">512</span><span class="p">)</span><span class="o">*</span><span class="n">getPrime</span><span class="p">(</span><span class="mi">512</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">e</span> <span class="o">=</span> <span class="mi">17</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">c1</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="n">getRandomNBitInteger</span><span class="p">(</span><span class="mi">512</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span> <span class="o">=</span> <span class="n">getRandomNBitInteger</span><span class="p">(</span><span class="mi">512</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">m2</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">m1</span> <span class="o">+</span> <span class="n">b</span>
</span></span><span class="line"><span class="cl"><span class="n">c2</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">m2</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;N=</span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;a=</span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;b=</span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;c1=</span><span class="si">{</span><span class="n">c1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;c2=</span><span class="si">{</span><span class="n">c2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">N</span><span class="o">=</span><span class="mi">123659932061175480826793608011321410436349950741155126876095701055301878519455031361569954900678263326118459719432097093055918891948664714258046001339215600541946755989049122600427628642622036472692779340339300158628581419220590868242848311473965406365501747491282544140645468809520929307937285660479491241363</span>
</span></span><span class="line"><span class="cl"><span class="n">a</span><span class="o">=</span><span class="mi">12795184347649957548397347648657609712242281197428253341891395348966629724842748696386579533843100833039565312645558384706282291396553602742473087674306336</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span><span class="o">=</span><span class="mi">12652561268961103936837420866306660440380907636430718507525953046969196471975210807471094652190751376751348655252244311630569860771118936181419956587387282</span>
</span></span><span class="line"><span class="cl"><span class="n">c1</span><span class="o">=</span><span class="mi">51991948160397341594095534046308905334052328129886214140433481879034095448631790463996064234310860642758645828216350970768732856439017324754993220774971081882007838091737307185049230846102962234452369235186705221800322142645874117556212685451861172069436515378795560228077509937484022552758984136308761496373</span>
</span></span><span class="line"><span class="cl"><span class="n">c2</span><span class="o">=</span><span class="mi">102367269426206577837660468860715696190840895268468904172938303357188227693435122799965957675733814903345970317009686706066325312156008609593926539768689081990544088825413585508055156925413722623286655819700429518477974133941543843635128782119973290018886257977205103150970429699110833604623614038282346303825</span>
</span></span><span class="line"><span class="cl"><span class="n">e</span><span class="o">=</span><span class="mi">17</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span><span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">s</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">c1</span><span class="p">,</span><span class="n">c2</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">R</span><span class="o">.&lt;</span><span class="n">X</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Zmod</span><span class="p">(</span><span class="n">N</span><span class="p">)[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">f1</span> <span class="o">=</span> <span class="n">X</span><span class="o">^</span><span class="n">e</span> <span class="o">-</span> <span class="n">c1</span>
</span></span><span class="line"><span class="cl">    <span class="n">f2</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span><span class="o">*</span><span class="n">a</span><span class="o">+</span> <span class="n">b</span><span class="p">)</span><span class="o">^</span><span class="n">e</span> <span class="o">-</span> <span class="n">c2</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">Integer</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">gcd</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span><span class="n">f2</span><span class="p">))</span><span class="o">.</span><span class="n">coefficients</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span> 
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">gcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="n">b</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">monic</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">gcd</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">%</span> <span class="n">b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">m</span><span class="o">=</span><span class="n">s</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">c1</span><span class="p">,</span><span class="n">c2</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">secret</span> <span class="kn">import</span> <span class="n">flag</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">num1</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">512</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">num2</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">512</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="n">num1</span><span class="o">&lt;</span><span class="n">num2</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">num2</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">512</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ring</span> <span class="o">=</span> <span class="n">RealField</span><span class="p">(</span><span class="mi">1050</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">num3</span> <span class="o">=</span> <span class="n">ring</span><span class="p">(</span><span class="n">num1</span><span class="p">)</span> <span class="o">/</span><span class="n">ring</span><span class="p">(</span><span class="n">num2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;num3=&#34;</span><span class="p">,</span><span class="n">num3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">512</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">q</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">512</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">n</span><span class="o">=</span><span class="n">p</span><span class="o">*</span><span class="n">q</span>
</span></span><span class="line"><span class="cl"><span class="n">e</span><span class="o">=</span><span class="mi">65537</span>
</span></span><span class="line"><span class="cl"><span class="n">m</span> <span class="o">=</span> <span class="n">bytes_to_long</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span><span class="o">=</span><span class="nb">pow</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;n=&#34;</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;c=&#34;</span><span class="p">,</span><span class="n">c</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">n2</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">512</span><span class="p">)</span> <span class="o">*</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">512</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">e1</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span><span class="mi">2000</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">e2</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span><span class="mi">2000</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">c1</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">p</span><span class="o">+</span><span class="n">num1</span><span class="p">,</span><span class="n">e1</span><span class="p">,</span><span class="n">n2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">c2</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">p</span><span class="o">+</span><span class="n">num2</span><span class="p">,</span><span class="n">e2</span><span class="p">,</span><span class="n">n2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">q1</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">512</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">leak1</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">q</span><span class="o">+</span><span class="n">q1</span><span class="p">,</span><span class="mi">2024</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">leak2</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">q1</span><span class="o">+</span><span class="mi">2024</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;n2=&#34;</span><span class="p">,</span><span class="n">n2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;e1=&#34;</span><span class="p">,</span><span class="n">e1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;e2=&#34;</span><span class="p">,</span><span class="n">e2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;c1=&#34;</span><span class="p">,</span><span class="n">c1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;c2=&#34;</span><span class="p">,</span><span class="n">c2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;leak1=&#34;</span><span class="p">,</span><span class="n">leak1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;leak2=&#34;</span><span class="p">,</span><span class="n">leak2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">num3= 1.36557212221826657073387899060669771982679822943621690677450888408226656788387273887547841291114809989272635809810564202247340711087479554863446719786359395466961253205133910506682801159622545780721946115442033391600881399634390008053822158098121985270501317972263356522400827768601773721146954464269212959784543085
</span></span></span><span class="line"><span class="cl"><span class="s2">n= 85105083975491693151454182116844944807066048677068373328227644321539783064315677834754866742549592569194223084173286381150626593510265361114796714226058887906219454795525438819082646860141163940340082006344850825956811992304447978369108606993344902286569100146695092703383844402883938506877787042873586279543
</span></span></span><span class="line"><span class="cl"><span class="s2">c= 8090472119640930864901421058741085326954308673260202542020919764880488559370287585797498390920330336595858609617432370825503480936376306766495089200286004922821787548265246289552343468177624634434613746605553770994437785042510225956023382347023663125411103947669109085411939772215657220674436476279268458980
</span></span></span><span class="line"><span class="cl"><span class="s2">n2= 101642316595332652021348165259853423287787139517550249986161819826180514401858258316466101056877182367161299111697465439636861942636526396547011727147471566130633614685728563576613692851860684686033186826342178072882901576159305747639645374751566751967096281105148714033096611618024355982220235949274576036321
</span></span></span><span class="line"><span class="cl"><span class="s2">e1= 1630
</span></span></span><span class="line"><span class="cl"><span class="s2">e2= 1866
</span></span></span><span class="line"><span class="cl"><span class="s2">c1= 8857135083997055103287497833179378469532619748945804429057682575070405217145941944821968708809563240261403711644389684947851643865895254406194464015430673347359589677809515117412321862622147634752091324365628790687343748145339949310696116239361890881096088375070083053010564890401663562726144984405628773323
</span></span></span><span class="line"><span class="cl"><span class="s2">c2= 44531030636557714647477473185500183066851251320453194953972504422367649302810396344051696851757189817391648356459225688318373454949578822468293099948132700460437006478679492801335689493431764882835346904225119630026545592437198370606462285405519745361570058335573353886454277790277663038008240372746639859253
</span></span></span><span class="line"><span class="cl"><span class="s2">leak1= 82301473255013183706458389946960254392188270550712533886416705365418418731488346328643954589202172816597173052792573628245245948345810581701878535280775967863966009605872386693838526935762655380705962833467046779524956212498594045378770790026387120339093736625186401934354434702063802537686761251873173518029
</span></span></span><span class="line"><span class="cl"><span class="s2">leak2= 43580171648136008789232340619597144591536098696024883687397347933098380327258730482377138309020375265135558484586783368757872008322883985094403855691297725907800406097129735499961231236473313141257901326737291586051506797429883866846199683028143924054925109557329949641367848264351523500925115860458645738192
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>DASTF çš„é¢˜ï¼Œå…ˆè¿åˆ†æ•°é€¼è¿‘æ¥è§£å¼€ num1 å’Œ num2ï¼Œç„¶åç”¨ç›¸å…³æ¶ˆæ¯æ”»å‡»ï¼Œæƒ…æŠ¥æœ‰è¯¯ï¼Œè¿™æ˜¯çŸ­å¡«å……æ”»å‡»</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">num3</span><span class="o">=</span> <span class="mf">1.36557212221826657073387899060669771982679822943621690677450888408226656788387273887547841291114809989272635809810564202247340711087479554863446719786359395466961253205133910506682801159622545780721946115442033391600881399634390008053822158098121985270501317972263356522400827768601773721146954464269212959784543085</span>
</span></span><span class="line"><span class="cl"><span class="n">n</span><span class="o">=</span> <span class="mi">85105083975491693151454182116844944807066048677068373328227644321539783064315677834754866742549592569194223084173286381150626593510265361114796714226058887906219454795525438819082646860141163940340082006344850825956811992304447978369108606993344902286569100146695092703383844402883938506877787042873586279543</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span><span class="o">=</span> <span class="mi">8090472119640930864901421058741085326954308673260202542020919764880488559370287585797498390920330336595858609617432370825503480936376306766495089200286004922821787548265246289552343468177624634434613746605553770994437785042510225956023382347023663125411103947669109085411939772215657220674436476279268458980</span>
</span></span><span class="line"><span class="cl"><span class="n">n2</span><span class="o">=</span> <span class="mi">101642316595332652021348165259853423287787139517550249986161819826180514401858258316466101056877182367161299111697465439636861942636526396547011727147471566130633614685728563576613692851860684686033186826342178072882901576159305747639645374751566751967096281105148714033096611618024355982220235949274576036321</span>
</span></span><span class="line"><span class="cl"><span class="n">e1</span><span class="o">=</span> <span class="mi">1630</span>
</span></span><span class="line"><span class="cl"><span class="n">e2</span><span class="o">=</span> <span class="mi">1866</span>
</span></span><span class="line"><span class="cl"><span class="n">e</span><span class="o">=</span><span class="mi">65537</span>
</span></span><span class="line"><span class="cl"><span class="n">c1</span><span class="o">=</span> <span class="mi">8857135083997055103287497833179378469532619748945804429057682575070405217145941944821968708809563240261403711644389684947851643865895254406194464015430673347359589677809515117412321862622147634752091324365628790687343748145339949310696116239361890881096088375070083053010564890401663562726144984405628773323</span>
</span></span><span class="line"><span class="cl"><span class="n">c2</span><span class="o">=</span> <span class="mi">44531030636557714647477473185500183066851251320453194953972504422367649302810396344051696851757189817391648356459225688318373454949578822468293099948132700460437006478679492801335689493431764882835346904225119630026545592437198370606462285405519745361570058335573353886454277790277663038008240372746639859253</span>
</span></span><span class="line"><span class="cl"><span class="n">leak1</span><span class="o">=</span> <span class="mi">82301473255013183706458389946960254392188270550712533886416705365418418731488346328643954589202172816597173052792573628245245948345810581701878535280775967863966009605872386693838526935762655380705962833467046779524956212498594045378770790026387120339093736625186401934354434702063802537686761251873173518029</span>
</span></span><span class="line"><span class="cl"><span class="n">leak2</span><span class="o">=</span> <span class="mi">43580171648136008789232340619597144591536098696024883687397347933098380327258730482377138309020375265135558484586783368757872008322883985094403855691297725907800406097129735499961231236473313141257901326737291586051506797429883866846199683028143924054925109557329949641367848264351523500925115860458645738192</span>
</span></span><span class="line"><span class="cl"><span class="n">t</span><span class="o">=</span><span class="n">continued_fraction</span><span class="p">(</span><span class="n">num3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">num1</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">numerator</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">is_prime</span><span class="p">(</span><span class="n">num1</span><span class="p">)</span> <span class="ow">and</span> <span class="n">num1</span><span class="o">.</span><span class="n">nbits</span><span class="p">()</span><span class="o">==</span><span class="mi">512</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">num2</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">denominator</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">num1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">num2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span><span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">s</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">e1</span><span class="p">,</span><span class="n">e2</span><span class="p">,</span><span class="n">c1</span><span class="p">,</span><span class="n">c2</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">R</span><span class="o">.&lt;</span><span class="n">X</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Zmod</span><span class="p">(</span><span class="n">n</span><span class="p">)[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">f1</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span><span class="o">+</span><span class="n">num1</span><span class="p">)</span><span class="o">**</span><span class="n">e1</span> <span class="o">-</span> <span class="n">c1</span>
</span></span><span class="line"><span class="cl">    <span class="n">f2</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span><span class="o">+</span><span class="n">num2</span><span class="p">)</span><span class="o">**</span><span class="n">e2</span> <span class="o">-</span> <span class="n">c2</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">Integer</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">gcd</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span><span class="n">f2</span><span class="p">))</span><span class="o">.</span><span class="n">coefficients</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span> 
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">gcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="n">b</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">monic</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">gcd</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">%</span> <span class="n">b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">=</span><span class="n">s</span><span class="p">(</span><span class="n">n2</span><span class="p">,</span><span class="n">e1</span><span class="p">,</span><span class="n">e2</span><span class="p">,</span><span class="n">c1</span><span class="p">,</span><span class="n">c2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">q</span><span class="o">=</span><span class="n">n</span><span class="o">//</span><span class="n">p</span>
</span></span><span class="line"><span class="cl"><span class="n">d</span><span class="o">=</span><span class="nb">pow</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">m</span><span class="o">=</span><span class="nb">pow</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div>
</section>


    <footer class="article-footer">
    

    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI&#43;WdtXRGWt2kTvGFasHpSy3SV"crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG&#43;vnGctmUb0ZY0l8"crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"integrity="sha384-&#43;VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4&#43;/RRE05"crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        const elementsToRender = [".main-article", ".widget--toc"];

        elementsToRender.forEach(selector => {
            const element = document.querySelector(selector);
            if (element) {
                renderMathInElement(element, {
                    delimiters: [
                        { left: "$$", right: "$$", display: true },
                        { left: "$", right: "$", display: false },
                        { left: "\\(", right: "\\)", display: false },
                        { left: "\\[", right: "\\]", display: true }
                    ],
                    ignoredClasses: ["gist"]
                });
            }
        });
    });
</script>
    
</article>


    

    

     
    
        
    <script
    src="https://giscus.app/client.js"
    data-repo="p3r0x/p3r0x.github.io"
    data-repo-id="R_kgDOQxf5tg"
    data-category="Announcements"
    data-category-id="DIC_kwDOQxf5ts4C0f3D"
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="top"
    data-theme="light"
    data-lang="zh-CN"
    data-loading=""
    crossorigin="anonymous"
    async
></script>
<script>
    function setGiscusTheme(theme) {
        let giscus = document.querySelector("iframe.giscus-frame");
        if (giscus) {
            giscus.contentWindow.postMessage(
                {
                    giscus: {
                        setConfig: {
                            theme: theme,
                        },
                    },
                },
                "https://giscus.app"
            );
        }
    }

    (function () {
        addEventListener("message", (e) => {
            if (event.origin !== "https://giscus.app") return;
            handler();
        });
        window.addEventListener("onColorSchemeChange", handler);

        function handler() {
            if (document.documentElement.dataset.scheme === "light") {
                setGiscusTheme('light');
            } else {
                setGiscusTheme('dark_dimmed');
            }
        }
    })();
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2025 - 
        
        2026 Perox
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.3f0660e16f46ed1544f4e216c2eb032398c2ec1b5abc424d80a1cbf71bf58f62.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css">
<div id="aplayer"></div>

<script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script>

<script>
const ap = new APlayer({
    container: document.getElementById('aplayer'),
    fixed: true,
    mini: true,
    autoplay: false,
    mutex: false,
    preload: 'metadata',
    order: 'random',
    theme: '#1e3a8a',
    audio: [
        {
            name: 'Somniomancer [null set]',
            artist: 'å¡å£¬å”±ç‰‡-MSR',
            url: '/music/å¡å£¬å”±ç‰‡-MSR; Crywolf - Somniomancer [null set].mp3',
            cover: '/music/21A7A866D4D502FFFF83C9810EEF5DAA.jpg'
        },
        {
            name: 'Touch of the Law',
            artist: 'å¡å£¬å”±ç‰‡-MSR',
            url: '/music/å¡å£¬å”±ç‰‡-MSR,Alec Justice,Echos - Touch of the Law.mp3',
            cover: '/music/21A7A866D4D502FFFF83C9810EEF5DAA.jpg'
        },
        {
            name: 'èµ´å¤§è’',
            artist: 'å¡å£¬å”±ç‰‡-MSR',
            url: '/music/å¡å£¬å”±ç‰‡-MSR; Kirara Magic - èµ´å¤§è’.mp3',
            cover: '/music/a9327ac600568afeeea76e01b00959e024723044.png'
        },
        {
            name: 'å¤©ä¸‹ä¸€ç™½',
            artist: 'å¡å£¬å”±ç‰‡-MSR',
            url: '/music/å¡å£¬å”±ç‰‡-MSR; BaoUner - å¤©ä¸‹ä¸€ç™½.mp3',
            cover: '/music/df72b29b5f78188aef2413b70b70054d420924396.jpg'
        }
    ]
});

const container = document.getElementById('aplayer');
container.addEventListener('dblclick', () => {
    ap.skipForward();
});
</script>

<style>
#aplayer {
    position: fixed;
    right: 20px;
    top: 70%;
    transform: translateY(-50%);
    z-index: 1000;
    width: 64px;
    height: 64px;
    border-radius: 50%;
    overflow: hidden;
    box-shadow: 0 8px 25px rgba(30,58,138,.45);
    transition: transform .3s ease, box-shadow .3s ease;
}

#aplayer:hover {
    transform: translateY(-50%) scale(1.08);
    box-shadow: 0 12px 35px rgba(30,58,138,.7);
}

#aplayer .aplayer-pic {
    border-radius: 50% !important;
}

#aplayer .aplayer-info,
#aplayer .aplayer-list,
#aplayer .aplayer-time {
    display: none !important;
}

#aplayer .aplayer-button {
    width: 100%;
    height: 100%;
}

#aplayer.aplayer-playing .aplayer-pic {
    animation: spin 6s linear infinite;
}

@keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

@media (max-width: 768px) {
    #aplayer {
        width: 52px;
        height: 52px;
        right: 12px;
    }
}
</style>

<style>
.highlight {
    position: relative;
    max-height: 400px;
    overflow: hidden;
}

.highlight.code-show {
    max-height: none !important;
}

.code-more-box {
    width: 100%;
    padding-top: 78px;
    background-image: linear-gradient(to bottom, rgba(255,255,255,0), #fff);
    position: absolute;
    left: 0;
    bottom: 0;
    z-index: 2;
}

.code-more-btn {
    display: block;
    margin: auto;
    width: 44px;
    height: 22px;
    background: #f0f0f5;
    border-top-left-radius: 8px;
    border-top-right-radius: 8px;
    padding-top: 6px;
    cursor: pointer;
}

.code-more-img {
    display: block;
    margin: auto;
    width: 22px;
    height: 16px;
    transition: transform .2s;
}

.highlight.code-show .code-more-img {
    transform: rotate(180deg);
}
</style>



<script>
(function () {
    function initCodeMoreBox() {
        document.querySelectorAll('.highlight').forEach(function (block) {
            if (block.dataset.codemoreInit) return;
            block.dataset.codemoreInit = '1';

            if (block.scrollHeight <= block.clientHeight) return;

            const box = document.createElement('div');
            box.className = 'code-more-box';

            const btn = document.createElement('span');
            btn.className = 'code-more-btn';

            btn.onclick = function () {
                block.classList.toggle('code-show');
            };

            const img = document.createElement('img');
            img.className = 'code-more-img';

   
            img.src = '/icons/codeMore.png';

            btn.appendChild(img);
            box.appendChild(btn);
            block.appendChild(box);
        });
    }

    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initCodeMoreBox);
    } else {
        initCodeMoreBox();
    }

    document.addEventListener('pjax:complete', initCodeMoreBox);
})();
</script>

<style>
  body {
    background-color: #f5f5f5; 
    background-image: url('/background/E517B06CCC3BC4F14D284CAD40BDB345.jpg');
    background-repeat: no-repeat;
    background-position: center top;
    background-size: cover;
    background-attachment: fixed;
  }
</style>
<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>Typed.js å½©è›‹é¡ºåºè·³è½¬ï¼ˆé¦–é¡µä¸è§¦å‘ï¼‰</title>
<script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12"></script>
<style>
#typed {
  font-size: 24px;
  color: #09fb01;
  min-height: 36px;
  text-align: center;
}
</style>
</head>
<body style="height:2000px; margin:0;">

<h1 id="typed"></h1>

<script>
const messages = [
  "åˆ°åº•å•¦ï¼åˆ«å†å¾€ä¸‹æ»‘äº†ï¼",
  "æ²¡æœ‰å½©è›‹ï¼Œä¹Ÿæ²¡æœ‰éšè—å†…å®¹â€¦",
  "å°±è¿™ä¹ˆç‚¹ä¸œè¥¿ï¼Œä½ å°±æ»‘åˆ°è¿™é‡Œäº†"
];

const easterMessage = "ä½ å‘ç°äº†æˆ‘çš„å½©è›‹ï¼Œè¿™å°±å¸¦ä½ å»na";

const jumpUrls = [
  "https://ys.mihoyo.com/",
  "https://www.bilibili.com/video/BV1GJ411x7h7/?spm_id_from=333.337.search-card.all.click",
];

let animationRunning = false;
let typed1, typed2;
let jumpTimeout;

function isScrolledToBottom() {
  const scrollTop = window.scrollY || document.documentElement.scrollTop;
  const windowHeight = window.innerHeight;
  const docHeight = document.documentElement.scrollHeight;
  return scrollTop + windowHeight >= docHeight - 10;
}

function handleScroll() {
  const typedElement = document.getElementById('typed');

  if (window.location.pathname === '/' || window.location.pathname === '/index.html') return;

  if (animationRunning) {
    if (!isScrolledToBottom()) {
      if (typed1) typed1.destroy();
      if (typed2) typed2.destroy();
      if (jumpTimeout) clearTimeout(jumpTimeout);
      typedElement.innerHTML = "";
      animationRunning = false;
    }
    return;
  }

  if (!animationRunning && isScrolledToBottom()) {
    animationRunning = true;

    const randomMsg = messages[Math.floor(Math.random() * messages.length)];
    const randomUrl = jumpUrls[Math.floor(Math.random() * jumpUrls.length)];
    typedElement.innerHTML = "";

    typed1 = new Typed('#typed', {
      strings: [randomMsg],
      typeSpeed: 120,
      backSpeed: 0,
      loop: false,
      showCursor: false,
      onStringTyped: function() {
        typed1.destroy();

        typed2 = new Typed('#typed', {
          strings: [easterMessage],
          typeSpeed: 50,
          backSpeed: 0,
          loop: false,
          showCursor: false,
          onStringTyped: function() {
            jumpTimeout = setTimeout(function() {
              if (isScrolledToBottom()) {
                window.location.href = randomUrl;
              } else {
                typedElement.innerHTML = "";
                animationRunning = false;
              }
            }, 900);
          }
        });
      }
    });
  }
}

window.addEventListener('scroll', handleScroll);
</script>

</body>
</html>

<style>
 body {
   background-color: #f5f5f5;
   background-image: url('/background/E517B06CCC3BC4F14D284CAD40BDB345.jpg');
   background-repeat: no-repeat;
   background-position: center top;
   background-size: cover;
   background-attachment: fixed;
 }

 #welcome-screen {
   position: fixed;
   top: 0;
   left: 0;
   width: 100%;
   height: 100vh;
   background: url('/background/E517B06CCC3BC4F14D284CAD40BDB345.jpg') no-repeat center center;
   background-size: cover;
   display: flex;
   align-items: center;
   justify-content: center;
   z-index: 10000;
   transition: opacity 0.8s ease-out;
 }

 #welcome-text {
   font-size: 3rem;
   color: #15b7e8;
   font-weight: bold;
   text-shadow: 2px 2px 8px rgba(255,255,255,0.9);
   white-space: nowrap;
   margin-top: -15vh;
 }

 #welcome-screen.fade-out {
   opacity: 0;
   pointer-events: none;
 }

 body.welcome-active {
   overflow: hidden;
 }
</style>

<div id="welcome-screen">
 <div id="welcome-text"></div>
</div>

<script>
 if (!sessionStorage.getItem('hasScrolled')) {
   const text = "ç°åœ¨å°±è®©æˆ‘ç”¨æ‰€æ‹¥æœ‰çš„ä¸€åˆ‡å»çˆ±ä½  å¬ä¸æ‡‚å—ï¼Ÿ";
   const welcomeScreen = document.getElementById('welcome-screen');
   const welcomeEl = document.getElementById('welcome-text');
   let index = 0;

   document.body.classList.add('welcome-active');
   window.scrollTo(0, 0);

   function typeWriter() {
     if (index < text.length) {
       welcomeEl.textContent += text.charAt(index);
       index++;
       setTimeout(typeWriter, 80);
     } else {
       setTimeout(function() {
         welcomeScreen.classList.add('fade-out');
         setTimeout(function() {
           welcomeScreen.remove();
           document.body.classList.remove('welcome-active');

           const mainContainer = document.querySelector('.container.main-container');
           if (mainContainer) {
             window.scrollTo({
               top: mainContainer.offsetTop,
               behavior: 'smooth'
             });
           } else {
             window.scrollTo({
               top: window.innerHeight * 0.9,
               behavior: 'smooth'
             });
           }

           sessionStorage.setItem('hasScrolled', 'true');
         }, 800);
       }, 1500);
     }
   }

   window.addEventListener('load', function() {
     setTimeout(typeWriter, 500);
   });
 } else {
   const welcomeScreen = document.getElementById('welcome-screen');
   if (welcomeScreen) {
     welcomeScreen.remove();
   }
 }
</script>


<script src="https://fastly.jsdelivr.net/npm/live2d-widget@3.1.4/lib/L2Dwidget.min.js"></script>

<script>
L2Dwidget.init({
    "model": {
        jsonPath: "https://unpkg.com/live2d-widget-model-z16@1.0.5/assets/z16.model.json",
        "scale": 1
    },
    "display": {
        "position": "left",
        "width": 220,      
        "height": 320,     
        "hOffset": 0,
        "vOffset": -20
    },
    "mobile": {
        "show": false
    },
    "react": {
        "opacity": 0.9
    }
});
</script>

<style>
@media (max-width: 768px) {
    #landlord {
        display: none;
    }
}
</style>

<canvas id="particle-line"></canvas>

<style>
#particle-line {
    position: fixed;
    inset: 0;
    z-index: -1;
    pointer-events: none;
}
</style>

<script>
const canvas = document.getElementById('particle-line');
const ctx = canvas.getContext('2d');

let w, h;
function resize() {
    w = canvas.width = window.innerWidth;
    h = canvas.height = window.innerHeight;
}
resize();
window.addEventListener('resize', resize);

const COUNT = 100;        
const MAX_DIST = 120;      
const MOUSE_DIST = 180;   
const COLOR = '15,30,90'; 

const particles = [];
const mouse = { x: null, y: null };

window.addEventListener('mousemove', e => {
    mouse.x = e.clientX;
    mouse.y = e.clientY;
});
window.addEventListener('mouseleave', () => {
    mouse.x = mouse.y = null;
});

function newParticle() {
    return {
        x: Math.random() * w,
        y: Math.random() * h,
        vx: (Math.random() - 0.5) * 0.4,
        vy: (Math.random() - 0.5) * 0.4,
        r: Math.random() * 1.6 + 0.6
    };
}

for (let i = 0; i < COUNT; i++) {
    particles.push(newParticle());
}

function draw() {
    ctx.clearRect(0, 0, w, h);

    for (let p of particles) {
        p.x += p.vx;
        p.y += p.vy;

        if (p.x < 0 || p.x > w) p.vx *= -1;
        if (p.y < 0 || p.y > h) p.vy *= -1;

        ctx.beginPath();
        ctx.fillStyle = `rgba(${COLOR},0.8)`;
        ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
        ctx.fill();
    }

    for (let i = 0; i < COUNT; i++) {
        for (let j = i + 1; j < COUNT; j++) {
            const dx = particles[i].x - particles[j].x;
            const dy = particles[i].y - particles[j].y;
            const dist = Math.sqrt(dx * dx + dy * dy);

            if (dist < MAX_DIST) {
                ctx.beginPath();
                ctx.strokeStyle = `rgba(${COLOR},${1 - dist / MAX_DIST})`;
                ctx.lineWidth = 0.6;
                ctx.moveTo(particles[i].x, particles[i].y);
                ctx.lineTo(particles[j].x, particles[j].y);
                ctx.stroke();
            }
        }
    }

    if (mouse.x !== null) {
        for (let p of particles) {
            const dx = p.x - mouse.x;
            const dy = p.y - mouse.y;
            const dist = Math.sqrt(dx * dx + dy * dy);

            if (dist < MOUSE_DIST) {
                ctx.beginPath();
                ctx.strokeStyle = `rgba(${COLOR},${1 - dist / MOUSE_DIST})`;
                ctx.lineWidth = 0.8;
                ctx.moveTo(p.x, p.y);
                ctx.lineTo(mouse.x, mouse.y);
                ctx.stroke();
            }
        }
    }

    requestAnimationFrame(draw);
}

draw();
</script>


<style>
#mouse-line-canvas {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    pointer-events: none;   
    z-index: 99999;         
}
</style>

<canvas id="mouse-line-canvas"></canvas>

<script>
(function() {
    const canvas = document.getElementById('mouse-line-canvas');
    if (!canvas) return;
    
    const ctx = canvas.getContext('2d');
    
    function resizeCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }
    resizeCanvas();
    window.addEventListener('resize', resizeCanvas);
    
    const points = [];
    const maxPoints = 20;
    let hue = 0;
    
    class Point {
        constructor(x, y, hue) {
            this.x = x;
            this.y = y;
            this.alpha = 1;
            this.radius = 3;
            this.hue = hue;
        }
        
        update() {
            this.alpha -= 0.015;
            this.radius += 0.2;
        }
        
        draw() {
            ctx.beginPath();
            ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
            ctx.fillStyle = `hsla(${this.hue}, 70%, 60%, ${this.alpha})`;
            ctx.fill();
        }
    }
    
    
    document.addEventListener('click', function(e) {
        const point = new Point(e.clientX, e.clientY, hue);
        points.push(point);
        hue = (hue + 20) % 360;
        
        if (points.length > maxPoints) {
            points.shift();
        }
    });
    
    
    document.addEventListener('touchstart', function(e) {
        const touch = e.touches[0];
        const point = new Point(touch.clientX, touch.clientY, hue);
        points.push(point);
        hue = (hue + 20) % 360;
        
        if (points.length > maxPoints) {
            points.shift();
        }
    });
    
    function animate() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        
        if (points.length > 1) {
            for (let i = 0; i < points.length - 1; i++) {
                const gradient = ctx.createLinearGradient(
                    points[i].x, points[i].y,
                    points[i + 1].x, points[i + 1].y
                );
                gradient.addColorStop(0, `hsla(${points[i].hue}, 70%, 60%, ${points[i].alpha})`);
                gradient.addColorStop(1, `hsla(${points[i + 1].hue}, 70%, 60%, ${points[i + 1].alpha})`);
                
                ctx.beginPath();
                ctx.moveTo(points[i].x, points[i].y);
                ctx.lineTo(points[i + 1].x, points[i + 1].y);
                ctx.strokeStyle = gradient;
                ctx.lineWidth = 2;
                ctx.stroke();
            }
        }
        
        for (let i = points.length - 1; i >= 0; i--) {
            points[i].update();
            points[i].draw();
            
            if (points[i].alpha <= 0) {
                points.splice(i, 1);
            }
        }
        
        requestAnimationFrame(animate);
    }
    
    animate();
})();
</script>

<style>
.highlight {
   position: relative;
   max-height: 400px;
   overflow: hidden;
}

.highlight.code-show {
   max-height: none !important;
}

.code-more-box {
   width: 100%;
   padding-top: 78px;
   background-image: linear-gradient(to bottom, rgba(255,255,255,0), #fff);
   position: absolute;
   left: 0;
   bottom: 0;
   z-index: 2;
}

.code-more-btn {
   display: block;
   margin: auto;
   width: 44px;
   height: 22px;
   background: #f0f0f5;
   border-top-left-radius: 8px;
   border-top-right-radius: 8px;
   padding-top: 6px;
   cursor: pointer;
}

.code-more-img {
   display: block;
   margin: auto;
   width: 22px;
   height: 16px;
   transition: transform .2s;
}

.highlight.code-show .code-more-img {
   transform: rotate(180deg);
}

 
.progress-bar-container {
   position: fixed;
   top: 0;
   left: 0;
   width: 100%;
   height: 4px;
   background: rgba(0,0,0,0.05);
   z-index: 99999;   
   pointer-events: none;   
}

.progress-bar {
   height: 100%;
   width: 0%;
   background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
   transition: width 0.2s ease-out;
   box-shadow: 0 0 10px rgba(102, 126, 234, 0.5);
}
</style>


<div class="progress-bar-container">
   <div class="progress-bar" id="progress-bar"></div>
</div>

<script>
(function () {
   
   function initCodeMoreBox() {
       document.querySelectorAll('.highlight').forEach(function (block) {
           if (block.dataset.codemoreInit) return;
           block.dataset.codemoreInit = '1';

           if (block.scrollHeight <= block.clientHeight) return;

           const box = document.createElement('div');
           box.className = 'code-more-box';

           const btn = document.createElement('span');
           btn.className = 'code-more-btn';

           btn.onclick = function () {
               block.classList.toggle('code-show');
           };

           const img = document.createElement('img');
           img.className = 'code-more-img';
           img.src = '/icons/codeMore.png';

           btn.appendChild(img);
           box.appendChild(btn);
           block.appendChild(box);
       });
   }

   
   function updateProgressBar() {
       const progressBar = document.getElementById('progress-bar');
       if (!progressBar) return;

       const winScroll = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;
       const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
       
       if (height > 0) {
           const scrolled = (winScroll / height) * 100;
           progressBar.style.width = Math.min(scrolled, 100) + '%';
       }
   }

   
   if (document.readyState === 'loading') {
       document.addEventListener('DOMContentLoaded', function() {
           initCodeMoreBox();
           updateProgressBar();
       });
   } else {
       initCodeMoreBox();
       updateProgressBar();
   }

   
   let ticking = false;
   window.addEventListener('scroll', function() {
       if (!ticking) {
           window.requestAnimationFrame(function() {
               updateProgressBar();
               ticking = false;
           });
           ticking = true;
       }
   });

   
   document.addEventListener('pjax:complete', function() {
       initCodeMoreBox();
       updateProgressBar();
   });
})();
</script>

<style>
  @font-face {
    font-family: 'WenYuanRoundedSC-Medium.otf';
    src: url(http://localhost:1313/font/WenYuanRoundedSC-Medium.otf) format('truetype');
  }

  :root {
    --base-font-family: 'WenYuanRoundedSC-Medium.otf';
    --code-font-family: 'WenYuanRoundedSC-Medium.otf';
  }
</style>

    </body>
</html>
